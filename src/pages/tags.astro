---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import { getAllTags } from '../utils/tags';

const allPosts = await getCollection('blog', ({ data }) => {
  return data.draft !== true;
});

const tags = getAllTags(allPosts);
---

<BaseLayout title="Tags" description="Explora todos los tags del blog">
  <!-- Header -->
  <div class="tags-header">
    <div class="header-content">
      <div class="header-title-group">
        <span class="header-icon">#</span>
        <h1 class="header-title">Tags</h1>
      </div>
      <p class="header-subtitle">
        {tags.length} {tags.length === 1 ? 'tag' : 'tags'} disponibles
      </p>
    </div>
  </div>

  <!-- Tags Cloud -->
  <div class="tags-cloud">
    {tags.map((tag) => (
      <a href={`/tag/${tag.slug}`} class="tag-item" style={`border-color: ${tag.color}; color: ${tag.color}`}>
        <span class="tag-name">#{tag.name}</span>
        <span class="tag-count">{tag.count}</span>
      </a>
    ))}
  </div>
</BaseLayout>

<style>
  /* Header */
  .tags-header {
    margin-bottom: 3rem;
    padding-bottom: 2rem;
    border-bottom: 2px solid var(--grid-line);
    position: relative;
  }

  .tags-header::after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg,
      transparent,
      var(--cyan-neon) 20%,
      var(--cyan-neon) 80%,
      transparent
    );
    opacity: 0.5;
    filter: blur(2px);
  }

  .header-content {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .header-title-group {
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .header-icon {
    font-family: var(--font-primary);
    font-size: 2rem;
    font-weight: 900;
    color: var(--cyan-neon);
    text-shadow: 0 0 20px var(--cyan-glow);
  }

  .header-title {
    font-family: var(--font-primary);
    font-size: 2.5rem;
    font-weight: 700;
    letter-spacing: 0.05em;
    color: var(--cyan-neon);
    text-shadow: 0 0 25px var(--cyan-glow);
    margin: 0;
  }

  .header-subtitle {
    font-family: 'Courier New', monospace;
    font-size: 1rem;
    color: var(--text-muted);
    margin: 0;
    padding-left: 3rem;
  }

  /* Tags Cloud */
  .tags-cloud {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    margin-bottom: 4rem;
  }

  .tag-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem 1.25rem;
    background: rgba(0, 217, 255, 0.05);
    border: 2px solid;
    border-radius: 6px;
    text-decoration: none;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
  }

  .tag-item::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, currentColor, transparent);
    opacity: 0.1;
    transition: left 0.4s ease;
  }

  .tag-item:hover::before {
    left: 100%;
  }

  .tag-item:hover {
    background: rgba(0, 217, 255, 0.15);
    box-shadow: 0 0 20px currentColor;
    transform: translateY(-3px) scale(1.05);
  }

  .tag-name {
    font-family: var(--font-primary);
    font-size: 1rem;
    font-weight: 600;
    letter-spacing: 0.05em;
  }

  .tag-count {
    font-family: 'Courier New', monospace;
    font-size: 0.875rem;
    padding: 0.25rem 0.5rem;
    background: currentColor;
    color: var(--bg-primary);
    border-radius: 4px;
    font-weight: 700;
    min-width: 2rem;
    text-align: center;
  }

  /* Responsive */
  @media (max-width: 768px) {
    .header-title {
      font-size: 2rem;
    }

    .header-icon {
      font-size: 1.5rem;
    }

    .header-subtitle {
      padding-left: 2.5rem;
    }

    .tags-cloud {
      gap: 0.75rem;
    }

    .tag-item {
      padding: 0.5rem 1rem;
    }

    .tag-name {
      font-size: 0.875rem;
    }

    .tag-count {
      font-size: 0.75rem;
    }
  }
</style>
